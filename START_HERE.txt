â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                           â•‘
â•‘        ğŸš€ APOLLO SERVER WITH REDIS - LOAD BALANCED SETUP ğŸš€             â•‘
â•‘                                                                           â•‘
â•‘                          START HERE!                                      â•‘
â•‘                                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‘‹ WELCOME!

Your Apollo Server project now has a complete load-balanced setup with
3 independent instances behind an Nginx load balancer.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš¡ QUICK START (3 Commands)

1. Start all services:
   ./start-load-balanced.sh

2. Open in browser:
   http://localhost:8080/lb-status

3. Test load distribution:
   ./test-load-balancer.sh 20

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“š DOCUMENTATION (Pick One)

Start with:
  â†’ SETUP_COMPLETE.md    (Summary of what was created)
  â†’ README.md            (Complete overview)
  â†’ QUICK_START.md       (Quick reference)
  â†’ GETTING_STARTED.md   (Quick index)

Detailed docs:
  â†’ LOAD_BALANCER_SETUP.md    (Technical details)
  â†’ ARCHITECTURE.md           (System diagrams)
  â†’ VERIFICATION_CHECKLIST.md (Testing guide)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ WHAT YOU GET

âœ… 3 Apollo Server instances (ports 4001, 4002, 4003)
âœ… Nginx load balancer (port 8080) - Least Connections algorithm
âœ… Request tracking - see which instance handled each request
âœ… Visual dashboard - http://localhost:8080/lb-status
âœ… Shared PostgreSQL database - all instances use same data
âœ… Shared Redis cache - distributed across instances
âœ… Health checks & failover - automatic recovery
âœ… Testing scripts - verify load distribution

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸš€ SERVICES YOU'LL HAVE RUNNING

Instance 1:     http://localhost:4001/graphql
Instance 2:     http://localhost:4002/graphql
Instance 3:     http://localhost:4003/graphql

Load Balancer:  http://localhost:8080/graphql
Dashboard:      http://localhost:8080/lb-status
Health Check:   http://localhost:8080/health

Database:       localhost:5438 (PostgreSQL)
Cache:          localhost:6379 (Redis)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š HOW IT WORKS

1. You make a request to: http://localhost:8080/graphql

2. Nginx load balancer receives it

3. It routes to the instance with fewest active connections
   (Least Connections algorithm)

4. Instance processes request and returns response

5. Response includes X-Instance-ID header showing which instance handled it

6. Logs show everything that happened

7. All instances share the same database and cache

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ§ª TEST THE SETUP

Option 1 - Automatic Test (Recommended):
  ./test-load-balancer.sh 30

  Shows: Distribution across instances (should be ~33% each)

Option 2 - Manual Test:
  curl http://localhost:8080/health

  Shows: Load balancer health status

Option 3 - View Dashboard:
  Open: http://localhost:8080/lb-status
  
  Shows: Visual status of all instances (updates every 5 seconds)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ FILES CREATED/MODIFIED

Configuration Files:
  âœ… docker-compose.yml       Multiple instances + Load Balancer setup
  âœ… nginx.conf              Load balancer configuration
  âœ… Dockerfile              Container image definition

Scripts:
  âœ… setup.sh                Initial setup
  âœ… start-load-balanced.sh  Start all services
  âœ… test-load-balancer.sh   Test load distribution

Documentation:
  âœ… SETUP_COMPLETE.md       What was created (comprehensive)
  âœ… README.md               Project overview
  âœ… QUICK_START.md          Quick reference
  âœ… GETTING_STARTED.md      Quick index
  âœ… SETUP_SUMMARY.md        Setup overview
  âœ… LOAD_BALANCER_SETUP.md  Technical details
  âœ… ARCHITECTURE.md         System diagrams
  âœ… VERIFICATION_CHECKLIST  Testing guide

Modified:
  âœ… src/index.ts            Added request tracking middleware

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”¥ ONE-COMMAND START

./start-load-balanced.sh

That's it! All services will start and you can access:
  Dashboard: http://localhost:8080/lb-status
  GraphQL:   http://localhost:8080/graphql

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ›‘ STOP SERVICES

docker-compose down

This keeps your data. To delete everything:

docker-compose down -v

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ˆ KEY FEATURES DEMONSTRATED

âœ¨ Load Balancing
   - Distributes requests across multiple instances
   - Uses Least Connections algorithm
   - Automatic failover and recovery

âœ¨ Request Tracking
   - Every request gets a unique ID
   - Response headers show which instance handled it
   - Console logs track everything

âœ¨ Multi-Instance Architecture
   - 3 independent Apollo Server instances
   - Each can handle requests independently
   - Shared database for data consistency

âœ¨ Health Monitoring
   - Automatic health checks every 5-10 seconds
   - Unhealthy instances removed from rotation
   - Visual dashboard shows status

âœ¨ Shared Infrastructure
   - PostgreSQL database shared by all instances
   - Redis cache shared by all instances
   - No data duplication or sync issues

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¡ NEXT STEPS

1. âœ… Read this file (you just did!)

2. âœ… Start the services:
     ./start-load-balanced.sh

3. âœ… Open the dashboard:
     http://localhost:8080/lb-status

4. âœ… Test load distribution:
     ./test-load-balancer.sh 30

5. âœ… Read the documentation:
     Start with README.md or QUICK_START.md

6. âœ… Monitor the logs:
     docker-compose logs -f

7. âœ… Make GraphQL queries:
     Use http://localhost:8080/graphql
     Watch the instance ID in response headers

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â“ QUESTIONS?

Check these files in order:
  1. SETUP_COMPLETE.md    - Summary and overview
  2. QUICK_START.md       - Quick reference
  3. README.md            - Detailed overview
  4. LOAD_BALANCER_SETUP.md - Technical deep dive
  5. ARCHITECTURE.md      - System diagrams

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… SETUP STATUS: COMPLETE & READY TO USE

Your load-balanced Apollo Server is configured and ready to go!

ğŸ‘‰ Next: Run ./start-load-balanced.sh and open http://localhost:8080/lb-status

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Created: January 20, 2025
Environment: Ubuntu 24.04.3 LTS with Docker
Status: âœ… Production Ready
